SELECT curse.repository_language language,total.count total_commits,curse.count curse_commits,curse.count/total.count * 100 curse_percentage FROM (SELECT repository_language,COUNT(*) as count FROM [publicdata:samples.github_timeline] WHERE REGEXP_MATCH(payload_commit_msg, r'[Ss]ucks|[Dd]a[mr]n') AND repository_language != '' GROUP BY repository_language ORDER BY count DESC) as curse JOIN (SELECT repository_language, COUNT(*) as count FROM [publicdata:samples.github_timeline] GROUP BY repository_language ORDER BY count DESC LIMIT 10) as total ON total.repository_language = curse.repository_language
ORDER BY curse_percentage DESC;